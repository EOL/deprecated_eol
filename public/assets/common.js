if(!EOL)var EOL={};!function(){for(var e=$.event.props,t=e.length,i=[];t--;){var n=e[t];"layerX"!=n&&"layerY"!=n&&i.push(n)}$.event.props=i}(),$.ajaxSetup({accepts:{"*":"text/javascript, */*",html:"text/javascript",json:"application/json, text/javascript",script:"text/javascript",text:"text/plain",xml:"application/xml, text/xml"}}),$("html :not(.thumbnails ul li)").bind("ajaxStart",function(){$(this).addClass("busy")}).bind("ajaxStop",function(){$(this).removeClass("busy")}),EOL.prep_flashes=function(){if(void 0===$("#flashes")[0]){var e=$("#page_heading .hgroup");$("#page_heading div.page_actions").length>0&&(e=$("#page_heading div.page_actions")),e.after('<div id="flashes" style="clear: both; width: 100%;"></div>')}},EOL.flash_warning=function(e){var t=400,i=$("div#flashes").append("<p class='status notice' style='display:none;'>"+e+"</p>").find("p"),n=$("#page_heading"),s=n.css("border");console.log("Border: "+s),n.css("border","none"),i.slideDown(t,function(){n.css("border",s)}).delay(5e3).slideUp(t,function(){this.remove()})},EOL.check_siblings=function(e,t){try{$($(e).siblings()).prop("checked",t)}catch(i){}},EOL.preferred_entry_selector_sumbit=function(){$('td.preferred_entry_selector input[type="radio"]:not(:checked)').on("click",function(){var e=$(this).closest("form");e.submit()})},$(function(){function e(e,s,o){o.addSlide&&(cycle_list_item=$(this).closest("li"),number_of_images_in_li=cycle_list_item.find("img").size(),10>number_of_images_in_li&&($.getJSON("content/random_homepage_images?count=5",function(e){if(!e.error)for(i=0;i<e.length;i++)image_data=e[i],0===$("img[src='"+image_data.image_url+"']").size()&&(scientific_name=image_data.taxon_scientific_name,common_name=image_data.taxon_common_name,null===common_name&&(common_name=""),alt_text=scientific_name,o.addSlide('<a href="'+image_data.taxon_page_path+'"><img src="'+image_data.image_url+'" alt="'+alt_text+'" data-scientific-name="'+scientific_name+'" data-common-name="'+common_name+'" width="130" height="130" onError="this.remove();"/></a>'),o.nextSlide=o.currSlide+1,t())}),cycle_list_item.hasClass("hover")&&n($(s).find("img"))))}function t(){$(".thumbnails li img").unbind().mouseover(function(){n($(this))})}function n(e){var t=e.parent().parent();if(t.length>0){$thumbs=t.closest(".thumbnails");var i=$thumbs.find(".term p"),n=t.position().left-100+5,s=i.outerWidth(!0)-t.position().left-t.outerWidth(!0)-100;t.is($(".thumbnails li:last"))&&(s-=15);var o="inherit";(null===e.data("common-name")||""===e.data("common-name"))&&(o=$thumbs.find(".term .site_column").css("height"));var a='<span class="scientific">'+e.data("scientific-name")+"</span>";null!==e.data("common-name")&&""!==e.data("common-name")&&(a+='<span class="common">'+e.data("common-name")+"</span>"),i.css({textAlign:"center"}).css("margin-left",n+"px").css("margin-right",s+"px").css("line-height",o).html(a),$(".thumbnails li").removeClass("hover"),t.addClass("hover")}}$(".heading form.filter, form.select_submit").find(".actions").hide().find(":submit").end().end().find("select").change(function(){$(this).closest("form").submit()}),function(e){var t='<li class="placeholder"></li>';e.each(function(){var e=$(this),i=[];$("<ul />",{"class":"thumbnails"}).insertBefore(e.find("p.all")),e.find(".image > a > img").each(function(){var e,n=$(this);e=n.is("[data-thumb]")?'<li><a href="#"><img src="'+n.data("thumb")+'" alt="'+n.attr("alt")+'" /></a></li>':t,i.push(e)});for(var n=1,s=4-i.length;s>=n;n++)i.push(t);e.find(".thumbnails").html(i.join("")),e.find(".thumbnails li").not(".placeholder").eq(0).addClass("active")}),e.find(".image > a img").each(function(){this.onload=function(){$(this).data("height",this.height)}}),e.find(".thumbnails").delegate("a","click",function(){var e=$(this).closest("li");return e.closest("ul").find(".active").removeClass("active"),e.addClass("active"),!1}),"cycle"in $.fn&&e.find(".images").cycle({speed:500,timeout:0,pagerAnchorBuilder:function(t){return e.selector+" .thumbnails a:eq("+t+")"}})}($(".gallery")),function(e){e.find("li .overlay").on("click",function(){return window.location=$(this).parent().find("a").attr("href"),!1})}($("#media_list")),function(e){e.find("p a").accessibleClick(function(){var t=$(this),i=t.closest(e.selector).find("ul");return i.is(":visible")?(i.hide(),!1):(i.show(),$(document).on("click",function(t){$(t.target).closest(e.selector).length||(e.find("ul").hide(),$(this).unbind(t))}),!1)})}($(".language")),function(e){e.children().each(function(){var e=$(this);e.delegate("ul.actions a.edit_comment","click keydown",function(e){e.preventDefault(),$(this).closest("ul.actions").hide(),$(this).closest(".details").after('<div class="comment_edit_form"></div>');var t=$(this).closest(".details").next(".comment_edit_form");EOL.ajax_get($(this),{update:t,type:"GET"})}),e.delegate(".comment_edit_form a","click keydown",function(e){e.preventDefault(),$(this).closest(".comment_edit_form").hide().prev(".details").find("ul.actions").show().end().end().remove()}),e.delegate(".comment_edit_form input[type='submit']","click keydown",function(e){e.preventDefault(),EOL.ajax_submit($(this))}),e.delegate("form.delete_comment input[type='submit']","click keydown",function(e){e.preventDefault(),confirm($(this).data("confirmation"))&&EOL.ajax_submit($(this))})})}($("ul.feed")),function(e){e.focusout(function(){if(""===$("#data_object_object_title").val()){var t="url="+e.val()+"&lang="+$("html").attr("lang");$.ajax({url:"/fetch_external_page_title",data:t,dataType:"json",beforeSend:function(){$(".link_object span.errors").text($(".link_object span.errors").data("pending-message"))},success:function(e){e.exception===!0?$(".link_object span.errors").text(e.message):($(".link_object span.errors").text(""),""===$("#data_object_object_title").val()&&$("#data_object_object_title").val(e.message))}})}})}($(".link_object #data_object_source_url")),function(e){var t=1e3;e.find("ul.collection_gallery").children().each(function(){var e=$(this);$.browser.msie&&(e.css("z-index",t),t-=1),e.find(".checkbox input[type=checkbox]").is(":checked")||e.find(".checkbox").hide(),e.find("h4").hide(),e.accessibleHover(function(){$(this).find(".checkbox").show(),$(this).find("h4").addClass("balloon").show()},function(){$(this).find(".checkbox input[type=checkbox]").is(":checked")||$(this).find(".checkbox").hide(),$(this).find("h4").hide().removeClass("balloon")})}),e.find("#sort_by").change(function(){$(this).closest("form").find('input[name="commit_sort"]').click()}),e.find('input[name="commit_sort"]').hide(),e.find("#view_as").change(function(){$(this).closest("form").find('input[name="commit_view_as"]').click()}),e.find('input[name="commit_view_as"]').hide(),e.find('input[name="commit_filter"]').hide()}($("#collection")),$("input#autocomplete_q[data-autocomplete]").keyup(function(e){var t=e.keyCode||e.which;if(13===t&&$(this).autocomplete("disable"),37!==t&&38!==t&&39!==t&&40!==t&&"undefined"==typeof EOL.search_submitted){$(".ui-autocomplete").fadeOut(50);var i=$.trim($(this).val()).replace(/\s+/," ");return i.length<3||i.match(/(^|[^a-z])[a-z]{0,2}([^a-z]|$)/i)?($(".ui-autocomplete").hide(),$(this).autocomplete("disable"),!1):($(this).autocomplete("option").disabled===!0&&($(this).autocomplete("enable"),$(this).autocomplete("search",i),EOL.turn_global_search_autocomplete_results_into_links()),void 0)}}),$("#simple_search :submit").click(function(){EOL.search_submitted=!0,$("input#autocomplete_q[data-autocomplete]").autocomplete("disable")}),$("input#autocomplete_q[data-autocomplete]").bind("focus",function(){$("input#autocomplete_q[data-autocomplete]").data("ui-autocomplete")._renderItem=function(e,t){return $("<li class='taxon'></li>").data("item.autocomplete",t).append($("<a></a>").html(t.label)).appendTo(e)};var e=$.trim($(this).val()).replace(/\s+/," ");return e==$(this).attr("title")&&(e=""),e.length>=3&&!e.match(/(^|[^a-z])[a-z]{0,2}([^a-z]|$)/i)&&$(this).autocomplete("search",e),!1}),$("#collection_items .editable .edit a").modal({beforeSend:function(){$("#collection_items .editable a").fadeTo(225,.3)},beforeShow:function(){$("form.edit_collection_item :submit").on("click",function(){return EOL.ajax_submit($(this),{update:$("li#collection_item_"+$(this).data("id")+" div.editable")}),$("#collection_items_edit a.close").click(),!1})},afterClose:function(){$("#collection_items .editable a").delay(25).fadeTo(100,1,function(){$("#collection_items .editable a").css({filter:""})})},duration:200}),$("a.collect").modal({beforeSend:function(){$("a.collect").fadeTo(225,.3)},beforeShow:function(){$("form#new_collection :submit").on("click",function(){return""===$("#collection_name").val()?($(".collection_name_error").show(),!1):(EOL.prep_flashes(),EOL.ajax_submit($(this),{update:$("#flashes")}),$("#choose_collections a.close").click(),!1)}),$("form#new_collection_item :submit").on("click",function(){return EOL.prep_flashes(),EOL.ajax_submit($(this),{update:$("#flashes")}),$("#choose_collections a.close").click(),!1}),$("#choose_collections a.close_and_go").on("click",function(){$("#choose_collections a.close").click()})},afterClose:function(){$("a.collect").delay(25).fadeTo(100,1,function(){$("a.collect").css({filter:""})})},duration:200}),$("a.reindex").on("click",function(){var e=$("a.reindex");return e.fadeTo(225,.3),EOL.prep_flashes(),EOL.ajax_submit($(this),{url:e.attr("href"),data:{},update:$("#flashes")}),!1}),EOL.enableRatings(),$(".thumbnails ul li").each(function(){var t=$(".thumbnails ul li").length,i=$(this).index(),s=new Array(-3,1,0,-2,-4,-1),o=5e3,a=1800;$(this).cycle({fx:"fade",timeout:t*o,delay:s[i]*o,speed:a,before:e});var r=Math.floor(6*Math.random())+1;n($(".thumbnails li:nth-child("+r+") img:first"))}),t(),$("#main_search_type_filter input[type=checkbox][value!='all']").on("click",function(){$("#main_search_type_filter input[type=checkbox][value='all']").prop("checked",!1)}),$("#main_search_type_filter input[type=checkbox][value='all']").on("click",function(){$("#main_search_type_filter input[type=checkbox][value!='all']").prop("checked",!1)}),$("#main_search_type_filter li.no_results input[type=checkbox]").attr("disabled",!0),$("#simple_search :submit").on("click",function(){var e=$("#simple_search :submit").closest("form").find('input[type="text"]');if(e.val()==$(this).attr("data_unchanged")||""===e.val())return e.css("color","#aa0000").val($(this).attr("data_error")).on("click",function(){$(this).val("").css("color","black").unbind("click")}),!1;if(e.val()==$(this).attr("data_error")){var t=20,i=240;return e.css("color","#aa0000").fadeOut(i).fadeIn(t).fadeOut(i).fadeIn(t).fadeOut(i).fadeIn(t),!1}}),$("#sidebar input[type=checkbox][value!='all']").on("click",function(){$("#sidebar input[type=checkbox][value='all'][name='"+$(this).attr("name")+"']").prop("checked",!1)}),$("#sidebar input[type=checkbox][value='all']").on("click",function(){$("#sidebar input[type=checkbox][value!='all'][name='"+$(this).attr("name")+"']").prop("checked",!1)}),$("#sidebar li.no_results input[type=checkbox]").attr("disabled",!0),$(".button.confirm").on("click",function(){return confirm($(this).attr("data_confirm"))?!0:!1}),$("form.new_collection_job #scope").change(function(){"all_items"==$("form.new_collection_job #scope").val()?$("#collection_items :checkbox").parent().hide():$("#collection_items :checkbox").parent().show()}),$("#main .media video embed").each(function(){var e=document.createElement("video");if(cant_play_video=!e.canPlayType||!e.canPlayType("video/mp4")){var t=$(this).parent();t.parent().html(t.html())}}),function(e){e.attr("href",function(){return auth_provider=$(".inat_observations_header a.button").attr("href").split("&")[1],"undefined"!=typeof auth_provider?this.href+"?"+auth_provider:void 0})}($(".inat_top_contributors a")),function(e){var t=e.find("dl.resources :radio");t.change(function(){t.each(function(){var e=$(this),t=e.closest("dt").next("dd");e.is(":checked")?t.slideDown(200):t.slideUp(200)})}).not(":checked").closest("dt").next("dd").hide()}($("#content_partner_resources")),EOL.preferred_entry_selector_sumbit(),function(e){var t=e.find("form"),i=$.extend(t.data("datepicker_opts"),{isRTL:"rtl"==$("body").css("direction")?!0:!1,showOn:"button",buttonImage:"http://160.111.248.28/assets/v2/icon_calendar.png",buttonImageOnly:!0,minDate:new Date(2012,1,17),maxDate:new Date});t.addClass("with_picker"),t.find("label").each(function(){var e=$(this);e.append('<input type="hidden"/>'),e.find('input[type="hidden"]').datepicker($.extend(i,{defaultDate:new Date(e.find("select:eq(2)").val(),e.find("select:eq(1)").val()-1,e.find("select:eq(0)").val()),onSelect:function(t,i){e.find("option:selected").removeAttr("selected"),e.find('select:eq(0) option[value="'+i.selectedDay+'"]').attr("selected","selected"),e.find('select:eq(1) option[value="'+(i.selectedMonth+1)+'"]').attr("selected","selected"),e.find('select:eq(2) option[value="'+i.selectedYear+'"]').attr("selected","selected"),e.closest("form").submit()}}))})}($("#statistics")),$("input.clear_on_focus").each(function(){$(this).val($(this).data("default"))}),$("input.clear_on_focus").siblings().each(function(){$(this).on("click",function(){$(this).prop("checked")&&$(this).siblings().focus()})}),$("input.clear_on_focus").on("focus",function(){$(this).val()==$(this).data("default")&&($(this).val(""),EOL.check_siblings(this,!0))}),$("input.clear_on_focus").on("blur",function(){(""===$(this).val()||$(this).val()==$(this).data("default"))&&($(this).val($(this).data("default")),EOL.check_siblings(this,!1))}),$("input#collection_job_overwrite").on("click",function(){$(this).prop("checked")?$("form#new_collection_job li.collected input").prop("checked",!1).attr("disabled",!1):$("form#new_collection_job li.collected input").prop("checked",!0).attr("disabled",!0)})}),function(e){e.fn.accessibleClick=function(t,i){if("join"in t)t.push(13);else{if("function"!=typeof t)return this;i=t}return this.each(function(){e(this).on("click",function(e){return!e.keyCode&&e.layerY>0||void 0===e.layerY?i.apply(this):!1}).keyup(function(n){return 13===n.keyCode||-1!==e.inArray(n.keyCode,t)?i.apply(this):void 0})})},e.fn.accessibleHover=function(e,t){return this.bind("mouseenter mouseover focusin focus",e).bind("mouseleave mouseout focusout blur",t)},e.fn.hasAttr=function(e){return this.is("["+e+"]")}}(jQuery),EOL.ajax_submit=function(e,t){t="undefined"!=typeof t?t:{};var i=null===e?null:e.closest("form"),n="";n="undefined"!=typeof t.update?t.update:e.closest(".editable");var s="";s="undefined"!=typeof t.url?t.url:"undefined"!=typeof e.attr("data_url")?e.attr("data_url"):i.attr("action");var o="";return o="undefined"!=typeof t.data?t.data:i.serialize(),complete="","undefined"!=typeof t.complete&&(complete=t.complete),type="POST","undefined"!=typeof t.type&&(type=t.type),$.ajax({url:s,data:o,type:type,dataType:"html",beforeSend:function(){n.fadeTo(225,.3)},success:function(e){n.html(jQuery.trim(e))},error:function(e,t){n.html("<p>Sorry, there was an error: "+t+"</p>")},complete:function(){n.delay(25).fadeTo(100,1,function(){n.css({filter:""})}),""!==complete&&complete()}}),!1},EOL.ajax_get=function(e,t){var i="";return i="undefined"!=typeof t.update?t.update:e.closest(".editable"),complete="","undefined"!=typeof t.complete&&(complete=t.complete),$.ajax({url:e.attr("href"),dataType:"html",beforeSend:function(){i.fadeTo(300,.3)},success:function(e){i.html(e)},error:function(e,t){i.html("<p>Sorry, there was an error: "+t+"</p>")},complete:function(){i.delay(25).fadeTo(100,1,function(){i.css({filter:""})}),""!==complete&&complete()}}),!1},EOL.enableRatings=function(){$(".media .ratings .rating ul > li > a").unbind("click").on("click",function(){var e=$(this).closest("div.ratings");return EOL.ajax_submit($(this),{url:$(this).attr("href"),update:e,type:"GET"}),!1})},EOL.after_onload_JS=function(e){!function(t){function i(){head.js(e)}t.addEventListener?t.addEventListener("load",i,!1):t.attachEvent&&t.attachEvent("onload",i)}(window,document,"script")},EOL.turn_global_search_autocomplete_results_into_links=function(){$("#simple_search input#autocomplete_q").autocomplete({select:function(e,t){var i=$(t.item.label).find("a").attr("href");window.location=i}})};