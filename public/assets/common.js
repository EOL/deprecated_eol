if(!EOL)var EOL={};!function(){for(var t=$.event.props,e=t.length,i=[];e--;){var n=t[e];"layerX"!=n&&"layerY"!=n&&i.push(n)}$.event.props=i}(),$.ajaxSetup({accepts:{"*":"text/javascript, */*",html:"text/javascript",json:"application/json, text/javascript",script:"text/javascript",text:"text/plain",xml:"application/xml, text/xml"}}),$("html :not(.thumbnails ul li)").bind("ajaxStart",function(){$(this).addClass("busy")}).bind("ajaxStop",function(){$(this).removeClass("busy")}),EOL.prep_flashes=function(){if(void 0===$("#flashes")[0]){var t=$("#page_heading .hgroup");$("#page_heading div.page_actions").length>0&&(t=$("#page_heading div.page_actions")),t.after('<div id="flashes" style="clear: both; width: 100%;"></div>')}},EOL.flash_warning=function(t){var e=400,i=$("div#flashes").append("<p class='status notice' style='display:none;'>"+t+"</p>").find("p"),n=$("#page_heading"),s=n.css("border");console.log("Border: "+s),n.css("border","none"),i.slideDown(e,function(){n.css("border",s)}).delay(5e3).slideUp(e,function(){this.remove()})},EOL.check_siblings=function(t,e){try{$($(t).siblings()).prop("checked",e)}catch(i){}},EOL.preferred_entry_selector_sumbit=function(){$('td.preferred_entry_selector input[type="radio"]:not(:checked)').on("click",function(){var t=$(this).closest("form");t.submit()})},$(function(){function t(t,s,o){o.addSlide&&(cycle_list_item=$(this).closest("li"),number_of_images_in_li=cycle_list_item.find("img").size(),10>number_of_images_in_li&&($.getJSON("content/random_homepage_images?count=5",function(t){if(!t.error)for(i=0;i<t.length;i++)image_data=t[i],0===$("img[src='"+image_data.image_url+"']").size()&&(scientific_name=image_data.taxon_scientific_name,common_name=image_data.taxon_common_name,null===common_name&&(common_name=""),alt_text=scientific_name,o.addSlide('<a href="'+image_data.taxon_page_path+'"><img src="'+image_data.image_url+'" alt="'+alt_text+'" data-scientific-name="'+scientific_name+'" data-common-name="'+common_name+'" width="130" height="130" onError="this.remove();"/></a>'),o.nextSlide=o.currSlide+1,e())}),cycle_list_item.hasClass("hover")&&n($(s).find("img"))))}function e(){$(".thumbnails li img").unbind().mouseover(function(){n($(this))})}function n(t){var e=t.parent().parent();if(e.length>0){$thumbs=e.closest(".thumbnails");var i=$thumbs.find(".term p"),n=e.position().left-100+5,s=i.outerWidth(!0)-e.position().left-e.outerWidth(!0)-100;e.is($(".thumbnails li:last"))&&(s-=15);var o="inherit";(null===t.data("common-name")||""===t.data("common-name"))&&(o=$thumbs.find(".term .site_column").css("height"));var a='<span class="scientific">'+t.data("scientific-name")+"</span>";null!==t.data("common-name")&&""!==t.data("common-name")&&(a+='<span class="common">'+t.data("common-name")+"</span>"),i.css({textAlign:"center"}).css("margin-left",n+"px").css("margin-right",s+"px").css("line-height",o).html(a),$(".thumbnails li").removeClass("hover"),e.addClass("hover")}}$(".heading form.filter, form.select_submit").find(".actions").hide().find(":submit").end().end().find("select").change(function(){$(this).closest("form").submit()}),function(t){var e='<li class="placeholder"></li>';t.each(function(){var t=$(this),i=[];$("<ul />",{"class":"thumbnails"}).insertBefore(t.find("p.all")),t.find(".image > a > img").each(function(){var t,n=$(this);t=n.is("[data-thumb]")?'<li><a href="#"><img src="'+n.data("thumb")+'" alt="'+n.attr("alt")+'" /></a></li>':e,i.push(t)});for(var n=1,s=4-i.length;s>=n;n++)i.push(e);t.find(".thumbnails").html(i.join("")),t.find(".thumbnails li").not(".placeholder").eq(0).addClass("active")}),t.find(".image > a img").each(function(){this.onload=function(){$(this).data("height",this.height)}}),t.find(".thumbnails").delegate("a","click",function(){var t=$(this).closest("li");return t.closest("ul").find(".active").removeClass("active"),t.addClass("active"),!1}),"cycle"in $.fn&&t.find(".images").cycle({speed:500,timeout:0,pagerAnchorBuilder:function(e){return t.selector+" .thumbnails a:eq("+e+")"}})}($(".gallery")),function(t){t.find("li .overlay").on("click",function(){return window.location=$(this).parent().find("a").attr("href"),!1})}($("#media_list")),function(t){t.find("p a").accessibleClick(function(){var e=$(this),i=e.closest(t.selector).find("ul");return i.is(":visible")?(i.hide(),!1):(i.show(),$(document).on("click",function(e){$(e.target).closest(t.selector).length||(t.find("ul").hide(),$(this).unbind(e))}),!1)})}($(".language")),function(t){t.children().each(function(){var t=$(this);t.delegate("ul.actions a.edit_comment","click keydown",function(t){t.preventDefault(),$(this).closest("ul.actions").hide(),$(this).closest(".details").after('<div class="comment_edit_form"></div>');var e=$(this).closest(".details").next(".comment_edit_form");EOL.ajax_get($(this),{update:e,type:"GET"})}),t.delegate(".comment_edit_form a","click keydown",function(t){t.preventDefault(),$(this).closest(".comment_edit_form").hide().prev(".details").find("ul.actions").show().end().end().remove()}),t.delegate(".comment_edit_form input[type='submit']","click keydown",function(t){t.preventDefault(),EOL.ajax_submit($(this))}),t.delegate("form.delete_comment input[type='submit']","click keydown",function(t){t.preventDefault(),confirm($(this).data("confirmation"))&&EOL.ajax_submit($(this))})})}($("ul.feed")),function(t){t.focusout(function(){if(""===$("#data_object_object_title").val()){var e="url="+t.val()+"&lang="+$("html").attr("lang");$.ajax({url:"/fetch_external_page_title",data:e,dataType:"json",beforeSend:function(){$(".link_object span.errors").text($(".link_object span.errors").data("pending-message"))},success:function(t){t.exception===!0?$(".link_object span.errors").text(t.message):($(".link_object span.errors").text(""),""===$("#data_object_object_title").val()&&$("#data_object_object_title").val(t.message))}})}})}($(".link_object #data_object_source_url")),function(t){var e=1e3;t.find("ul.collection_gallery").children().each(function(){var t=$(this);$.browser.msie&&(t.css("z-index",e),e-=1),t.find(".checkbox input[type=checkbox]").is(":checked")||t.find(".checkbox").hide(),t.find("h4").hide(),t.accessibleHover(function(){$(this).find(".checkbox").show(),$(this).find("h4").addClass("balloon").show()},function(){$(this).find(".checkbox input[type=checkbox]").is(":checked")||$(this).find(".checkbox").hide(),$(this).find("h4").hide().removeClass("balloon")})}),t.find("#sort_by").change(function(){$(this).closest("form").find('input[name="commit_sort"]').click()}),t.find('input[name="commit_sort"]').hide(),t.find("#view_as").change(function(){$(this).closest("form").find('input[name="commit_view_as"]').click()}),t.find('input[name="commit_view_as"]').hide(),t.find('input[name="commit_filter"]').hide()}($("#collection")),$("input#autocomplete_q[data-autocomplete]").keyup(function(t){var e=t.keyCode||t.which;if(13===e&&$(this).autocomplete("disable"),37!==e&&38!==e&&39!==e&&40!==e&&"undefined"==typeof EOL.search_submitted){$(".ui-autocomplete").fadeOut(50);var i=$.trim($(this).val()).replace(/\s+/," ");return i.length<3||i.match(/(^|[^a-z])[a-z]{0,2}([^a-z]|$)/i)?($(".ui-autocomplete").hide(),$(this).autocomplete("disable"),!1):($(this).autocomplete("option").disabled===!0&&($(this).autocomplete("enable"),$(this).autocomplete("search",i),EOL.turn_global_search_autocomplete_results_into_links()),void 0)}}),$("#simple_search :submit").click(function(){EOL.search_submitted=!0,$("input#autocomplete_q[data-autocomplete]").autocomplete("disable")}),$("input#autocomplete_q[data-autocomplete]").bind("focus",function(){$("input#autocomplete_q[data-autocomplete]").data("ui-autocomplete")._renderItem=function(t,e){return $("<li class='taxon'></li>").data("item.autocomplete",e).append($("<a></a>").html(e.label)).appendTo(t)};var t=$.trim($(this).val()).replace(/\s+/," ");return t==$(this).attr("title")&&(t=""),t.length>=3&&!t.match(/(^|[^a-z])[a-z]{0,2}([^a-z]|$)/i)&&$(this).autocomplete("search",t),!1}),$("#collection_items .editable .edit a").modal({beforeSend:function(){$("#collection_items .editable a").fadeTo(225,.3)},beforeShow:function(){$("form.edit_collection_item :submit").on("click",function(){return EOL.ajax_submit($(this),{update:$("li#collection_item_"+$(this).data("id")+" div.editable")}),$("#collection_items_edit a.close").click(),!1})},afterClose:function(){$("#collection_items .editable a").delay(25).fadeTo(100,1,function(){$("#collection_items .editable a").css({filter:""})})},duration:200}),$("a.collect").modal({beforeSend:function(){$("a.collect").fadeTo(225,.3)},beforeShow:function(){$("form#new_collection :submit").on("click",function(){return""===$("#collection_name").val()?($(".collection_name_error").show(),!1):(EOL.prep_flashes(),EOL.ajax_submit($(this),{update:$("#flashes")}),$("#choose_collections a.close").click(),!1)}),$("form#new_collection_item :submit").on("click",function(){return EOL.prep_flashes(),EOL.ajax_submit($(this),{update:$("#flashes")}),$("#choose_collections a.close").click(),!1}),$("#choose_collections a.close_and_go").on("click",function(){$("#choose_collections a.close").click()})},afterClose:function(){$("a.collect").delay(25).fadeTo(100,1,function(){$("a.collect").css({filter:""})})},duration:200}),$("a.reindex").on("click",function(){var t=$("a.reindex");return t.fadeTo(225,.3),EOL.prep_flashes(),EOL.ajax_submit($(this),{url:t.attr("href"),data:{},update:$("#flashes")}),!1}),EOL.enableRatings(),$(".thumbnails ul li").each(function(){var e=$(".thumbnails ul li").length,i=$(this).index(),s=new Array(-3,1,0,-2,-4,-1),o=5e3,a=1800;$(this).cycle({fx:"fade",timeout:e*o,delay:s[i]*o,speed:a,before:t});var r=Math.floor(6*Math.random())+1;n($(".thumbnails li:nth-child("+r+") img:first"))}),e(),$("#main_search_type_filter input[type=checkbox][value!='all']").on("click",function(){$("#main_search_type_filter input[type=checkbox][value='all']").prop("checked",!1)}),$("#main_search_type_filter input[type=checkbox][value='all']").on("click",function(){$("#main_search_type_filter input[type=checkbox][value!='all']").prop("checked",!1)}),$("#main_search_type_filter li.no_results input[type=checkbox]").attr("disabled",!0),$("#simple_search :submit").on("click",function(){var t=$("#simple_search :submit").closest("form").find('input[type="text"]');if(t.val()==$(this).attr("data_unchanged")||""===t.val())return t.css("color","#aa0000").val($(this).attr("data_error")).on("click",function(){$(this).val("").css("color","black").unbind("click")}),!1;if(t.val()==$(this).attr("data_error")){var e=20,i=240;return t.css("color","#aa0000").fadeOut(i).fadeIn(e).fadeOut(i).fadeIn(e).fadeOut(i).fadeIn(e),!1}}),$("#sidebar input[type=checkbox][value!='all']").on("click",function(){$("#sidebar input[type=checkbox][value='all'][name='"+$(this).attr("name")+"']").prop("checked",!1)}),$("#sidebar input[type=checkbox][value='all']").on("click",function(){$("#sidebar input[type=checkbox][value!='all'][name='"+$(this).attr("name")+"']").prop("checked",!1)}),$("#sidebar li.no_results input[type=checkbox]").attr("disabled",!0),$(".button.confirm").on("click",function(){return confirm($(this).attr("data_confirm"))?!0:!1}),$("form.new_collection_job #scope").change(function(){"all_items"==$("form.new_collection_job #scope").val()?$("#collection_items :checkbox").parent().hide():$("#collection_items :checkbox").parent().show()}),$("#main .media video embed").each(function(){var t=document.createElement("video");if(cant_play_video=!t.canPlayType||!t.canPlayType("video/mp4")){var e=$(this).parent();e.parent().html(e.html())}}),function(t){t.attr("href",function(){return auth_provider=$(".inat_observations_header a.button").attr("href").split("&")[1],"undefined"!=typeof auth_provider?this.href+"?"+auth_provider:void 0})}($(".inat_top_contributors a")),function(t){var e=t.find("dl.resources :radio");e.change(function(){e.each(function(){var t=$(this),e=t.closest("dt").next("dd");t.is(":checked")?e.slideDown(200):e.slideUp(200)})}).not(":checked").closest("dt").next("dd").hide()}($("#content_partner_resources")),EOL.preferred_entry_selector_sumbit(),function(t){var e=t.find("form"),i=$.extend(e.data("datepicker_opts"),{isRTL:"rtl"==$("body").css("direction")?!0:!1,showOn:"button",buttonImage:"http://160.111.248.29/assets/v2/icon_calendar.png",buttonImageOnly:!0,minDate:new Date(2012,1,17),maxDate:new Date});e.addClass("with_picker"),e.find("label").each(function(){var t=$(this);t.append('<input type="hidden"/>'),t.find('input[type="hidden"]').datepicker($.extend(i,{defaultDate:new Date(t.find("select:eq(2)").val(),t.find("select:eq(1)").val()-1,t.find("select:eq(0)").val()),onSelect:function(e,i){t.find("option:selected").removeAttr("selected"),t.find('select:eq(0) option[value="'+i.selectedDay+'"]').attr("selected","selected"),t.find('select:eq(1) option[value="'+(i.selectedMonth+1)+'"]').attr("selected","selected"),t.find('select:eq(2) option[value="'+i.selectedYear+'"]').attr("selected","selected"),t.closest("form").submit()}}))})}($("#statistics")),$("input.clear_on_focus").each(function(){$(this).val($(this).data("default"))}),$("input.clear_on_focus").siblings().each(function(){$(this).on("click",function(){$(this).prop("checked")&&$(this).siblings().focus()})}),$("input.clear_on_focus").on("focus",function(){$(this).val()==$(this).data("default")&&($(this).val(""),EOL.check_siblings(this,!0))}),$("input.clear_on_focus").on("blur",function(){(""===$(this).val()||$(this).val()==$(this).data("default"))&&($(this).val($(this).data("default")),EOL.check_siblings(this,!1))}),$("input#collection_job_overwrite").on("click",function(){$(this).prop("checked")?$("form#new_collection_job li.collected input").prop("checked",!1).attr("disabled",!1):$("form#new_collection_job li.collected input").prop("checked",!0).attr("disabled",!0)})}),function(t){t.fn.accessibleClick=function(e,i){if("join"in e)e.push(13);else{if("function"!=typeof e)return this;i=e}return this.each(function(){t(this).on("click",function(t){return!t.keyCode&&t.layerY>0||void 0===t.layerY?i.apply(this):!1}).keyup(function(n){return 13===n.keyCode||-1!==t.inArray(n.keyCode,e)?i.apply(this):void 0})})},t.fn.accessibleHover=function(t,e){return this.bind("mouseenter mouseover focusin focus",t).bind("mouseleave mouseout focusout blur",e)},t.fn.hasAttr=function(t){return this.is("["+t+"]")}}(jQuery),EOL.ajax_submit=function(t,e){e="undefined"!=typeof e?e:{};var i=null===t?null:t.closest("form"),n="";n="undefined"!=typeof e.update?e.update:t.closest(".editable");var s="";s="undefined"!=typeof e.url?e.url:"undefined"!=typeof t.attr("data_url")?t.attr("data_url"):i.attr("action");var o="";return o="undefined"!=typeof e.data?e.data:i.serialize(),complete="","undefined"!=typeof e.complete&&(complete=e.complete),type="POST","undefined"!=typeof e.type&&(type=e.type),$.ajax({url:s,data:o,type:type,dataType:"html",beforeSend:function(){n.fadeTo(225,.3)},success:function(t){n.html(jQuery.trim(t))},error:function(t,e){n.html("<p>Sorry, there was an error: "+e+"</p>")},complete:function(){n.delay(25).fadeTo(100,1,function(){n.css({filter:""})}),""!==complete&&complete()}}),!1},EOL.ajax_get=function(t,e){var i="";return i="undefined"!=typeof e.update?e.update:t.closest(".editable"),complete="","undefined"!=typeof e.complete&&(complete=e.complete),$.ajax({url:t.attr("href"),dataType:"html",beforeSend:function(){i.fadeTo(300,.3)},success:function(t){i.html(t)},error:function(t,e){i.html("<p>Sorry, there was an error: "+e+"</p>")},complete:function(){i.delay(25).fadeTo(100,1,function(){i.css({filter:""})}),""!==complete&&complete()}}),!1},EOL.enableRatings=function(){$(".media .ratings .rating ul > li > a").unbind("click").on("click",function(){var t=$(this).closest("div.ratings");return EOL.ajax_submit($(this),{url:$(this).attr("href"),update:t,type:"GET"}),!1})},EOL.after_onload_JS=function(t){!function(e){function i(){head.js(t)}e.addEventListener?e.addEventListener("load",i,!1):e.attachEvent&&e.attachEvent("onload",i)}(window,document,"script")},EOL.turn_global_search_autocomplete_results_into_links=function(){$("#simple_search input#autocomplete_q").autocomplete({select:function(t,e){var i=$(e.item.label).find("a").attr("href");window.location=i}})};