- item_type ||= en_type(collection_item)
.checkbox
  = check_box_tag "collection_items[]", collection_item.id, @selected_collection_items.include?(collection_item.id.to_s) || @select_all, :id => "collection_item_#{collection_item.id}"
- if ['image_map', 'image', 'video', 'sound'].include?(item_type)
  = render :partial => "shared/item_summary_media.html.haml", :locals => {:item => collection_item.object, :en_type => item_type}
- elsif ! item_type.blank?
  = render :partial => "shared/item_summary_#{item_type}.html.haml", :locals => {:item => collection_item.object}
-# When JS is disabled, you are taken to a page specific to the collection item, which has its own form:
- if defined?(item_form)
  - form_for(@collection_item) do |f|
    %fieldset
      = label_tag :collection_item_annotation, I18n.t(:collection_item_annotation_label), {:class => 'assistive'}
      = f.text_area :annotation, :rows => 2, :cols => 60
      = submit_tag I18n.t(:save_annotation_submit_button)
- else
  %p
    = collection_item.annotation
  /
    %p
      .collection_item_sort_field_form
        - parent_form.fields_for :collection_items, collection_item do |item_form|
          %fieldset
            = item_form.label :sort_field, I18n.t(:sort_field)
            = item_form.text_field :sort_field
            = submit_tag I18n.t(:update)
  %p.edit
    = link_to(I18n.t(:edit_annotation), '#') # Really, we don't want this to go anywhere, since the form is right
    -# ...below, for non-JS users. This is sub-optimal for non-JS users, but see note above.
  -# Doing this because HR had a full form tag here, but we don't want/need one:
  .collection_item_form{:style => 'clear: both; padding-top: 1em'}
    - parent_form.fields_for :collection_items, collection_item do |item_form|
      %fieldset
        = item_form.label :annotation, I18n.t(:collection_item_annotation_label), {:class => 'assistive'}
        = item_form.text_area :annotation, :rows => 2, :cols => 60
      %fieldset.actions
        = submit_tag I18n.t(:save_annotation_submit_button)
        %a(href="#") cancel
