/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.plugins.add("iframedialog",{requires:["dialog"],onLoad:function(){CKEDITOR.dialog.addIframe=function(e,t,i,n,a,o,r){var s={type:"iframe",src:i,width:"100%",height:"100%"};s.onContentLoad="function"==typeof o?o:function(){var e=this.getElement(),t=e.$.contentWindow;if(t.onDialogEvent){var i=this.getDialog(),n=function(e){return t.onDialogEvent(e)};i.on("ok",n),i.on("cancel",n),i.on("resize",n),i.on("hide",function(e){i.removeListener("ok",n),i.removeListener("cancel",n),i.removeListener("resize",n),e.removeListener()}),t.onDialogEvent({name:"load",sender:this,editor:i._.editor})}};var l={title:t,minWidth:n,minHeight:a,contents:[{id:"iframe",label:t,expand:!0,elements:[s]}]};for(var c in r)l[c]=r[c];this.add(e,function(){return l})},function(){var e=function(e,t,i){if(!(arguments.length<3)){var n=this._||(this._={}),a=t.onContentLoad&&CKEDITOR.tools.bind(t.onContentLoad,this),o=CKEDITOR.tools.cssLength(t.width),r=CKEDITOR.tools.cssLength(t.height);n.frameId=CKEDITOR.tools.getNextId()+"_iframe",e.on("load",function(){var e=CKEDITOR.document.getById(n.frameId),t=e.getParent();t.setStyles({width:o,height:r})});var s={src:"%2",id:n.frameId,frameborder:0,allowtransparency:!0},l=[];"function"==typeof t.onContentLoad&&(s.onload="CKEDITOR.tools.callFunction(%1);"),CKEDITOR.ui.dialog.uiElement.call(this,e,t,l,"iframe",{width:o,height:r},s,""),i.push('<div style="width:'+o+";height:"+r+';" id="'+this.domId+'"></div>'),l=l.join(""),e.on("show",function(){var e=CKEDITOR.document.getById(n.frameId),i=e.getParent(),o=CKEDITOR.tools.addFunction(a),r=l.replace("%1",o).replace("%2",CKEDITOR.tools.htmlEncode(t.src));i.setHtml(r)})}};e.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.dialog.addUIElement("iframe",{build:function(t,i,n){return new e(t,i,n)}})}()}});